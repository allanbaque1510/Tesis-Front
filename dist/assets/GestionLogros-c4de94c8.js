import{r,A as je,_ as fe,g as pe,m as be,k as Ce,h as X,o as ye,q as ve,b as J,j as e,O as oe,B as z,c as R,d as y,e as G,P as Se,t as ke,T as ue}from"./index-15240922.js";import{U as v}from"./UtilService-4db337ed.js";import{F as j,C as M}from"./index-5590f4ee.js";import{R as F}from"./row-5d227883.js";import{I as me}from"./index-be7a82b5.js";import{S as W,C as B,b as L,E as Q,a as ne,T as he}from"./index-6ab464cc.js";import{B as _}from"./index-9451a5c1.js";import{C as N,T as xe,a as le,R as Le}from"./Table-b4bf00f1.js";import{A as ce}from"./index-e68c2b59.js";import{T as de}from"./index-ea7575cb.js";import{E as Me}from"./EditOutlined-ea388460.js";import"./BaseInput-d53a2d9c.js";import"./TextArea-a7b7f909.js";import"./EyeOutlined-f74af4a3.js";import"./styleChecker-bc4901ce.js";import"./scrollTo-528c30a2.js";import"./useForceUpdate-d8c4c42e.js";var Fe={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112c17.7 0 32 14.3 32 32v736c0 17.7-14.3 32-32 32H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32zM639.98 338.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-square",theme:"filled"};const Ae=Fe;var we=function(a,m){return r.createElement(je,fe({},a,{ref:m,icon:Ae}))},Ee=r.forwardRef(we);const Ie=Ee,Pe=t=>{const{componentCls:a,sizePaddingEdgeHorizontal:m,colorSplit:l,lineWidth:o,textPaddingInline:f,orientationMargin:i,verticalMarginInline:d}=t;return{[a]:Object.assign(Object.assign({},Ce(t)),{borderBlockStart:`${X(o)} solid ${l}`,"&-vertical":{position:"relative",top:"-0.06em",display:"inline-block",height:"0.9em",marginInline:d,marginBlock:0,verticalAlign:"middle",borderTop:0,borderInlineStart:`${X(o)} solid ${l}`},"&-horizontal":{display:"flex",clear:"both",width:"100%",minWidth:"100%",margin:`${X(t.dividerHorizontalGutterMargin)} 0`},[`&-horizontal${a}-with-text`]:{display:"flex",alignItems:"center",margin:`${X(t.dividerHorizontalWithTextGutterMargin)} 0`,color:t.colorTextHeading,fontWeight:500,fontSize:t.fontSizeLG,whiteSpace:"nowrap",textAlign:"center",borderBlockStart:`0 ${l}`,"&::before, &::after":{position:"relative",width:"50%",borderBlockStart:`${X(o)} solid transparent`,borderBlockStartColor:"inherit",borderBlockEnd:0,transform:"translateY(50%)",content:"''"}},[`&-horizontal${a}-with-text-left`]:{"&::before":{width:`calc(${i} * 100%)`},"&::after":{width:`calc(100% - ${i} * 100%)`}},[`&-horizontal${a}-with-text-right`]:{"&::before":{width:`calc(100% - ${i} * 100%)`},"&::after":{width:`calc(${i} * 100%)`}},[`${a}-inner-text`]:{display:"inline-block",paddingBlock:0,paddingInline:f},"&-dashed":{background:"none",borderColor:l,borderStyle:"dashed",borderWidth:`${X(o)} 0 0`},[`&-horizontal${a}-with-text${a}-dashed`]:{"&::before, &::after":{borderStyle:"dashed none none"}},[`&-vertical${a}-dashed`]:{borderInlineStartWidth:o,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},[`&-plain${a}-with-text`]:{color:t.colorText,fontWeight:"normal",fontSize:t.fontSize},[`&-horizontal${a}-with-text-left${a}-no-default-orientation-margin-left`]:{"&::before":{width:0},"&::after":{width:"100%"},[`${a}-inner-text`]:{paddingInlineStart:m}},[`&-horizontal${a}-with-text-right${a}-no-default-orientation-margin-right`]:{"&::before":{width:"100%"},"&::after":{width:0},[`${a}-inner-text`]:{paddingInlineEnd:m}}})}},$e=t=>({textPaddingInline:"1em",orientationMargin:.05,verticalMarginInline:t.marginXS}),ze=pe("Divider",t=>{const a=be(t,{dividerHorizontalWithTextGutterMargin:t.margin,dividerHorizontalGutterMargin:t.marginLG,sizePaddingEdgeHorizontal:0});return[Pe(a)]},$e,{unitless:{orientationMargin:!0}});var Oe=globalThis&&globalThis.__rest||function(t,a){var m={};for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&a.indexOf(l)<0&&(m[l]=t[l]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,l=Object.getOwnPropertySymbols(t);o<l.length;o++)a.indexOf(l[o])<0&&Object.prototype.propertyIsEnumerable.call(t,l[o])&&(m[l[o]]=t[l[o]]);return m};const Ve=t=>{const{getPrefixCls:a,direction:m,divider:l}=r.useContext(ye),{prefixCls:o,type:f="horizontal",orientation:i="center",orientationMargin:d,className:O,rootClassName:$,children:w,dashed:E,plain:S,style:A}=t,h=Oe(t,["prefixCls","type","orientation","orientationMargin","className","rootClassName","children","dashed","plain","style"]),p=a("divider",o),[b,k,V]=ze(p),I=i.length>0?`-${i}`:i,T=!!w,x=i==="left"&&d!=null,n=i==="right"&&d!=null,Y=ve(p,l==null?void 0:l.className,k,V,`${p}-${f}`,{[`${p}-with-text`]:T,[`${p}-with-text${I}`]:T,[`${p}-dashed`]:!!E,[`${p}-plain`]:!!S,[`${p}-rtl`]:m==="rtl",[`${p}-no-default-orientation-margin-left`]:x,[`${p}-no-default-orientation-margin-right`]:n},O,$),U=r.useMemo(()=>typeof d=="number"?d:/^\d+$/.test(d)?Number(d):d,[d]),K=Object.assign(Object.assign({},x&&{marginLeft:U}),n&&{marginRight:U});return b(r.createElement("div",Object.assign({className:Y,style:Object.assign(Object.assign({},l==null?void 0:l.style),A)},h,{role:"separator"}),w&&f!=="vertical"&&r.createElement("span",{className:`${p}-inner-text`,style:K},w)))},re=Ve,Te=t=>{const a=J(),[m]=j.useForm(),[l,o]=r.useState(!1),[f,i]=r.useState([]),[d,O]=r.useState([]),[$,w]=r.useState([]),[E,S]=r.useState([]),A=f.length>0&&f.length<d.length,h=d.length===f.length,p=()=>{a(R());const x=m.getFieldsValue();v.saveLogroAprendizaje(x).then(n=>{n.data.ok&&(t.setData(),t.cerrar())}).catch(n=>{a(y({success:!1,title:"Error al agregar logro de aprendizaje",message:n.response.data.error}))}).finally(()=>{a(G())})},b=()=>{o(!0);const x=m.getFieldsValue();v.obtenerMaterias(x).then(n=>{n.data.ok&&O(n.data.data)}).catch(n=>{a(y({success:!1,title:"Error al obtener las materias",message:n.response.data.error}))}).finally(()=>{o(!1)})},k=x=>{i(x)},V=x=>{i(x.target.checked?d.map(n=>n.value):[])};r.useEffect(()=>{m.setFieldsValue({materias:f})},[f]);const I=()=>{a(R()),v.getComboCarreras().then(x=>{x.data.ok&&w(x.data.data)}).catch(x=>{a(y({success:!1,title:"Error al asignar los logros",message:x.response.data.error}))}).finally(()=>a(G()))};r.useEffect(()=>{I()},[]);const T=x=>{v.obtenerPeriodoNominaCarreraDocenteMateria(x).then(n=>{n.data.ok&&S(n.data.data)}).catch(n=>{a(y({success:!1,title:"Error al obtener los periodos",message:n.response.data.error}))})};return e.jsx(oe,{footer:"",title:t.title,open:t.status,onCancel:t.cerrar,children:e.jsxs(j,{form:m,layout:"vertical",onFinish:p,children:[e.jsxs(F,{children:[e.jsx(M,{style:{width:"100%"},children:e.jsx(j.Item,{label:"Descripcion del logro",name:"descripcion",rules:[{required:!0,message:"Por favor ingrese una descripcion"}],children:e.jsx(me,{})})}),e.jsx(M,{style:{width:"100%"},children:e.jsx(j.Item,{label:"Carreras",name:"carrera",rules:[{required:!0,message:"Seleccione una carrera"}],children:e.jsx(W,{placeholder:"Seleccione una carrera...",options:$,onChange:T})})}),e.jsx(M,{style:{width:"100%"},children:e.jsx(j.Item,{label:"Periodos",name:"periodos",rules:[{required:!0,message:"Seleccione un periodo"}],children:e.jsx(W,{placeholder:"Seleccione un periodo...",options:E,onChange:b})})})]}),e.jsx(F,{children:e.jsx(M,{style:{width:"100%"},children:e.jsx(B,{styles:{title:{overflow:"visible"}},title:e.jsxs(F,{justify:"space-between",children:[e.jsx(_,{offset:[15,0],count:d.length,children:e.jsx("span",{children:"Materias"})})," ",f.length>0&&e.jsx(_,{count:f.length,children:"Seleccionados"})," "]}),children:l?e.jsxs(e.Fragment,{children:[e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0})]}):d.length>0?e.jsxs(e.Fragment,{children:[e.jsx(N,{indeterminate:A,onChange:V,checked:h,children:"Seleccionar todos"}),e.jsx(re,{}),e.jsx(j.Item,{style:{height:"200px",overflowY:"auto"},name:"materias",rules:[{required:!0,message:"Seleccione las materias"}],children:e.jsx(N.Group,{style:{display:"flex",flexDirection:"column"},onChange:k,value:f,options:d})})]}):e.jsx(Q,{})})})}),e.jsx(F,{justify:"end",children:e.jsxs(M,{children:[e.jsx(z,{type:"primary",style:{marginInline:"10px"},htmlType:"submit",children:"Guardar"}),e.jsx(z,{onClick:t.cerrar,children:"Cerrar"})]})})]})})},De=t=>{const a=J(),[m]=j.useForm();r.useEffect(()=>{Object.keys(t.data).length>0&&m.setFieldsValue({descripcion:t.data.descripcion})},[t.data]);const l=()=>{a(R());const o=m.getFieldsValue();v.modificarLogroAprendizaje({id_logros:t.data.id_logros,descripcion:o.descripcion}).then(f=>{f.data.ok&&(t.setData(i=>i.map(d=>d.id_logros===t.data.id_logros?{...d,descripcion:o.descripcion}:d)),t.cerrar())}).catch(f=>{a(y({success:!1,title:"Error al agregar logro de aprendizaje",message:f.response.data.error}))}).finally(()=>{a(G())})};return e.jsx(oe,{footer:"",title:t.title,open:t.status,onCancel:t.cerrar,children:e.jsxs(j,{form:m,layout:"vertical",onFinish:l,children:[e.jsx(F,{children:e.jsx(M,{style:{width:"100%"},children:e.jsx(j.Item,{label:"Descripcion del logro",name:"descripcion",children:e.jsx(me,{})})})}),e.jsx(F,{justify:"end",children:e.jsxs(M,{children:[e.jsx(z,{type:"primary",style:{marginInline:"10px"},htmlType:"submit",children:"Guardar"}),e.jsx(z,{onClick:t.cerrar,children:"Cerrar"})]})})]})})},ge=t=>e.jsx(oe,{open:t.status,onCancel:t.cerrar,footer:null,children:e.jsx(Se,{status:"warning",title:t.title,subTitle:t.message,extra:e.jsxs(F,{justify:"center",children:[e.jsx(M,{style:{marginInline:"10px"},children:e.jsxs(z,{type:"primary",onClick:t.funcion,children:[e.jsx(ne,{}),"Aceptar"]})}),e.jsx(M,{style:{marginInline:"10px"},children:e.jsxs(z,{onClick:t.cerrar,children:[e.jsx(ke,{}),"Cancelar"]})})]})})}),Be=()=>{const[t]=j.useForm(),a=J(),[m,l]=r.useState([]),[o,f]=r.useState([]),[i,d]=r.useState([]),[O,$]=r.useState([]),[w,E]=r.useState(!1),[S,A]=r.useState(!1),[h,p]=r.useState([]),[b,k]=r.useState([]),[V,I]=r.useState({}),[T,x]=r.useState(!1);r.useEffect(()=>{t.setFieldsValue({materias:h,logros:b})},[h,b]);const n=h.length>0&&h.length<o.length,Y=o.length===h.length,U=b.length>0&&b.length<i.length,K=i.length===b.length,Z=()=>{a(R()),v.getComboCarreras().then(g=>{g.data.ok&&l(g.data.data)}).catch(g=>{a(y({success:!1,title:"Error al asignar los logros",message:g.response.data.error}))}).finally(()=>a(G()))},ee=(g,s)=>{I(s),E(!0),A(!0);const C=t.getFieldsValue();v.obtenerMaterias(C).then(P=>{P.data.ok&&(f(P.data.data),ae())}).catch(P=>{a(y({success:!1,title:"Error al obtener las materias",message:P.response.data.error}))}).finally(()=>{E(!1)})},te=g=>{v.obtenerPeriodoNominaCarreraDocenteMateria(g).then(s=>{s.data.ok&&$(s.data.data)}).catch(s=>{a(y({success:!1,title:"Error al obtener los periodos",message:s.response.data.error}))})},ae=()=>{A(!0),v.obtenerLogrosAprendizaje().then(g=>{d(g.data.data.map((s,C)=>({value:s.id_logros,label:e.jsxs(e.Fragment,{children:[e.jsx(de,{color:"green",children:s.codigo}),s.descripcion]})})))}).catch(g=>{a(y({success:!1,title:"Error al obtener logros",message:g.response.data.error}))}).finally(()=>A(!1))},se=g=>{p(g)},c=g=>{p(g.target.checked?o.map(s=>s.value):[])},u=g=>{k(g)},q=g=>{k(g.target.checked?i.map(s=>s.value):[])},D=()=>{a(R());const g=t.getFieldsValue();v.asignarLogrosAprendizajeMasivo(g).then(s=>{s.data.ok&&(a(y({success:!0,title:"Asignacion de logros masivo exitoso!"})),x(!1),p([]),k([]),t.resetFields())}).catch(s=>{a(y({success:!1,title:"Error al asignar logros masivamente",message:s.response.data.error}))}).finally(()=>a(G()))};r.useEffect(()=>{Z()},[]);const ie=o.filter(g=>h.includes(g.value)).map((g,s)=>({...g,key:s,accion:e.jsx(ue,{title:"Quitar de la lista",children:e.jsx(Ie,{onClick:()=>p(h.filter(C=>C!==g.value)),style:{color:"#FC7F80",fontSize:"20px"}})})}));return e.jsxs("div",{children:[e.jsx(ge,{status:T,cerrar:()=>x(!1),title:"Atencion!",message:e.jsxs(e.Fragment,{children:["Esta seguro que desea continuar, se remplazaran los logros de las siguientes materias, en el siguiente periodo:",e.jsx(xe,{dataSource:ie,columns:[{dataIndex:"label",title:V.label},{dataIndex:"accion",title:"",width:50}],pagination:!1,scroll:{y:240}})]}),funcion:()=>D()}),e.jsx(ce,{type:"warning",message:e.jsx("b",{children:"ATENCION!"}),description:"Se sustituiran los logros de aprendizaje de las materias seleccionadas, en el periodo seleccionado",showIcon:!0}),e.jsxs(j,{form:t,layout:"vertical",children:[e.jsx(j.Item,{label:"Carreras",name:"carrera",children:e.jsx(W,{placeholder:"Seleccione una carrera...",options:m,onChange:te})}),e.jsx(j.Item,{label:"Periodos",name:"periodos",children:e.jsx(W,{placeholder:"Seleccione un periodo...",options:O,onChange:ee})}),e.jsxs(F,{justify:"space-between",children:[e.jsx(M,{xs:24,sm:24,md:11,lg:11,xl:11,children:e.jsx(B,{title:e.jsxs(F,{justify:"space-between",children:[e.jsxs("span",{children:["Materias",e.jsx(_,{count:o.length})]})," ",h.length>0&&e.jsxs("span",{children:["Seleccionados",e.jsx(_,{count:h.length})]})," "]}),children:w?e.jsxs(e.Fragment,{children:[e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0})]}):o.length>0?e.jsxs(e.Fragment,{children:[e.jsx(N,{indeterminate:n,onChange:c,checked:Y,children:"Seleccionar todos"}),e.jsx(re,{}),e.jsx(j.Item,{style:{height:"200px",overflowY:"auto"},name:"materias",children:e.jsx(N.Group,{style:{display:"flex",flexDirection:"column"},onChange:se,value:h,options:o})})]}):e.jsx(Q,{})})}),e.jsx(M,{xs:24,sm:24,md:11,lg:11,xl:11,children:e.jsx(B,{title:e.jsxs(e.Fragment,{children:["Logros de aprendizaje",e.jsx(_,{count:b.length})," "]}),children:S?e.jsxs(e.Fragment,{children:[e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0})]}):i.length>0?e.jsxs(e.Fragment,{children:[e.jsx(N,{indeterminate:U,onChange:q,checked:K,children:"Seleccionar todos"}),e.jsx(re,{}),e.jsx(j.Item,{style:{height:"200px",overflowY:"auto"},name:"logros",children:e.jsx(N.Group,{style:{display:"flex",flexDirection:"column"},onChange:u,options:i})})]}):e.jsx(Q,{})})})]}),e.jsx(F,{justify:"end",children:e.jsxs(z,{onClick:()=>x(!0),htmlType:"submit",disabled:!(h.length>0&&b.length>0),type:"primary",style:{marginBlock:"15px"},children:[e.jsx(ne,{}),"  Asignar logros"]})})]})]})},Ne=()=>{const[t]=j.useForm(),a=J(),[m,l]=r.useState([]),[o,f]=r.useState([]),[i,d]=r.useState({}),[O,$]=r.useState({}),[w,E]=r.useState(!1),[S,A]=r.useState([]),[h,p]=r.useState([]),[b,k]=r.useState([]),[V,I]=r.useState(!1),T=S.length>0&&S.length<o.length,x=o.length===S.length,n=()=>{a(R()),v.getComboCarreras().then(c=>{c.data.ok&&l(c.data.data)}).catch(c=>{a(y({success:!1,title:"Error al asignar los logros",message:c.response.data.error}))}).finally(()=>a(G()))},Y=c=>{v.obtenerPeriodoNominaCarreraDocenteMateria(c).then(u=>{u.data.ok&&k(u.data.data)}).catch(u=>{a(y({success:!1,title:"Error al obtener los periodos",message:u.response.data.error}))})},U=(c,u)=>{d(u),E(!0);const q=t.getFieldsValue();v.obtenerMateriasConLogros({periodos:q.periodo_referencio,carrera:q.carrera}).then(D=>{D.data.ok&&f(D.data.data)}).catch(D=>{a(y({success:!1,title:"Error al obtener las materias",message:D.response.data.error}))}).finally(()=>{E(!1),K()})},K=()=>{const c=t.getFieldsValue();v.obtenerLogrosPeriodo({periodos:c.periodo_referencio,carrera:c.carrera}).then(u=>{u.data.ok&&p(u.data.data)}).catch(u=>{a(y({success:!1,title:"Error al obtener los logros por periodo y carrera",message:u.response.data.error}))})},Z=c=>{A(c)},ee=c=>{A(c.target.checked?o.map(u=>u.value):[])};r.useEffect(()=>{n()},[]),r.useEffect(()=>{t.setFieldsValue({materias:S})},[S]);const te=()=>{a(R());const c=t.getFieldsValue();v.clonarLogrosPorPeriodo(c).then(u=>{u.data.ok&&(a(y({success:!0,title:"Datos clonados exitosamente!"})),I(!1),t.resetFields(),A([]),f([]))}).catch(u=>{a(y({success:!1,title:"Error al obtener las materias",message:u.response.data.error}))}).finally(()=>a(G()))},ae=b.map((c,u)=>({...c,key:u,disabled:c.value===i.value})),se=h==null?void 0:h.filter(c=>S.includes(c.id_materia)).map((c,u)=>({title:c.materia,key:`${u}-${c.id_materia}`,children:c.logros.map((q,D)=>({key:`${u}-${c.id_materia}-${D}`,title:e.jsxs(e.Fragment,{children:[e.jsx(de,{color:"green",children:q.codigo_logro})," ",q.logro]})}))}));return e.jsxs("div",{children:[e.jsx(ge,{status:V,cerrar:()=>I(!1),title:"¿Esta seguro que desea continuar?",message:e.jsxs(e.Fragment,{children:["Se asignaran los logros de las materias seleccionadas del periodo ",e.jsx("b",{children:i.label})," , en el siguiente periodo: ",e.jsx("b",{children:O.label})]}),funcion:()=>te()}),e.jsx(ce,{type:"warning",message:e.jsx("b",{children:"ATENCION!"}),description:"Si las materias del periodo seleccionado tiene logros al momento de clonarla, estos se sustituiran por los logros de referencia asignado",showIcon:!0}),e.jsxs(j,{form:t,layout:"vertical",children:[e.jsx(j.Item,{label:"Carreras",name:"carrera",children:e.jsx(W,{placeholder:"Seleccione una carrera...",options:m,onChange:Y})}),e.jsxs(F,{justify:"space-between",children:[e.jsx(M,{xs:11,sm:11,md:11,lg:11,xl:11,children:e.jsx(j.Item,{label:"Periodo referencia",name:"periodo_referencio",children:e.jsx(W,{placeholder:"Seleccione un periodo...",onChange:U,options:b})})}),e.jsx(M,{xs:11,sm:11,md:11,lg:11,xl:11,children:e.jsx(j.Item,{label:"Periodo nuevo",name:"periodo",children:e.jsx(W,{disabled:!Object.keys(i).length>0,placeholder:"Seleccione un periodo...",options:ae,onChange:(c,u)=>$(u)})})})]}),e.jsxs(F,{justify:"space-between",children:[e.jsx(M,{xs:24,sm:24,md:11,lg:11,xl:11,children:e.jsx(B,{title:e.jsxs(e.Fragment,{children:["Materias",e.jsx(_,{count:o.length})," "]}),children:w?e.jsxs(e.Fragment,{children:[e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0})]}):o.length>0?e.jsxs(e.Fragment,{children:[e.jsx(N,{indeterminate:T,onChange:ee,checked:x,children:"Seleccionar todos"}),e.jsx(re,{}),e.jsx(j.Item,{style:{height:"200px",overflowY:"auto"},name:"materias",children:e.jsx(N.Group,{style:{display:"flex",flexDirection:"column"},onChange:Z,options:o})})]}):e.jsx(Q,{})})}),e.jsx(M,{xs:24,sm:24,md:11,lg:11,xl:11,children:e.jsx(B,{title:e.jsxs(e.Fragment,{children:["Vista Previa",e.jsx(_,{count:S.length})," "]}),children:S.length>0?e.jsx(e.Fragment,{children:e.jsx(le,{showLine:!0,height:295,defaultExpandAll:!0,treeData:se})}):e.jsx(Q,{})})})]}),e.jsx(F,{justify:"end",children:e.jsx(M,{style:{marginBlock:"20px"},children:e.jsxs(z,{type:"primary",disabled:!S.length>0,onClick:()=>I(!0),children:[" ",e.jsx(ne,{})," Clonar logros"]})})})]})]})},_e=()=>{const[t]=j.useForm(),a=J(),[m,l]=r.useState([]),[o,f]=r.useState([]),[i,d]=r.useState([]),[O,$]=r.useState([]),[w,E]=r.useState(!1),[S,A]=r.useState(!1),[h,p]=r.useState([]),[b,k]=r.useState([]),[V,I]=r.useState(!1),[T,x]=r.useState(!1),[n,Y]=r.useState({}),U=n[h]?n[h].length>0&&n[h].length<i.length:!1,K=n[h]?i.length===n[h].length:!1,Z=()=>{a(R()),v.getComboCarreras().then(s=>{s.data.ok&&l(s.data.data)}).catch(s=>{a(y({success:!1,title:"Error al asignar los logros",message:s.response.data.error}))}).finally(()=>a(G()))},ee=(s,C)=>{E(!0),A(!0);const P=t.getFieldsValue();t.resetFields(["materias","logros"]),p([]),k([]),c(),v.obtenerMaterias(P).then(H=>{H.data.ok&&(f(H.data.data),ae())}).catch(H=>{a(y({success:!1,title:"Error al obtener las materias",message:H.response.data.error}))}).finally(()=>{E(!1)})},te=s=>{v.obtenerPeriodoNominaCarreraDocenteMateria(s).then(C=>{C.data.ok&&$(C.data.data)}).catch(C=>{a(y({success:!1,title:"Error al obtener los periodos",message:C.response.data.error}))})},ae=()=>{A(!0),v.obtenerLogrosAprendizaje().then(s=>{d(s.data.data.map((C,P)=>({value:C.id_logros,label:e.jsxs(e.Fragment,{children:[e.jsx(de,{color:"green",children:C.codigo}),C.descripcion]})})))}).catch(s=>{a(y({success:!1,title:"Error al obtener logros",message:s.response.data.error}))}).finally(()=>A(!1))},se=()=>{a(R());const s=t.getFieldValue();v.asignarLogrosPorMateria({carrera:s.carrera,periodo:s.periodos,data:n}).then(C=>{C.data.ok&&a(y({success:!0,title:"Asignación de logros por materia exitoso!"}))}).catch(C=>{a(y({success:!1,title:"Error al obtener logros",message:C.response.data.error}))}).finally(()=>{a(G()),I(!1)})},c=()=>{const s=t.getFieldsValue();v.obtenerMateriasLogrosPeriodo(s).then(C=>{Y(C.data.data)}).catch(C=>{a(y({success:!1,title:"Error al obtener los logros asignados al periodo por materia",message:C.response.data.error}))})},u=s=>{p(s.target.value),t.setFieldsValue({logros:n[s.target.value]}),k(n[s.target.value]?n[s.target.value]:[])},q=s=>{k(s)},D=s=>{const C=s.target.checked?i.map(P=>P.value):[];k(s.target.checked?i.map(P=>P.value):[]),t.setFieldsValue({logros:C})};r.useEffect(()=>{Z()},[]),r.useEffect(()=>{const s=t.getFieldsValue();s.materias!==void 0&&s.logros!==void 0&&Y({...n,[s.materias]:b})},[b]);const ie=Object.keys(n).map(s=>parseInt(s,10)),g=o.filter(s=>ie.includes(s.value)).map((s,C)=>{const P=i.filter(H=>n[s.value].includes(H.value)).map(H=>({title:H.label,key:H.value+"-"+s.value}));return{title:s.label,key:s.value,children:P}});return e.jsxs("div",{children:[e.jsxs(oe,{title:"Vista previa",open:T,onCancel:()=>x(!1),footer:"",children:[e.jsx(B,{children:e.jsx(le,{showLine:!0,height:295,treeData:g})}),e.jsx(F,{justify:"end",children:e.jsx(z,{style:{marginTop:"20px"},onClick:()=>x(!1),children:"Cerrar"})})]}),e.jsx(ge,{status:V,cerrar:()=>I(!1),title:"Atencion!",message:e.jsxs(e.Fragment,{children:["¿Esta seguro que desea continuar?",e.jsx(B,{children:e.jsx(le,{showLine:!0,height:295,treeData:g})})]}),funcion:()=>se()}),e.jsxs(j,{form:t,layout:"vertical",children:[e.jsx(j.Item,{label:"Carreras",name:"carrera",children:e.jsx(W,{placeholder:"Seleccione una carrera...",options:m,onChange:te})}),e.jsx(j.Item,{label:"Periodos",name:"periodos",children:e.jsx(W,{placeholder:"Seleccione un periodo...",options:O,onChange:ee})}),e.jsxs(F,{justify:"space-between",children:[e.jsx(M,{xs:24,sm:24,md:11,lg:11,xl:11,children:e.jsx(B,{styles:{title:{overflow:"visible"}},title:e.jsxs(F,{justify:"space-between",children:[e.jsxs("span",{style:{marginTop:"5px"},children:["Materias",e.jsx(_,{offset:[2,-20],count:o.length})]})," ",Object.keys(n).length>0&&e.jsx(_,{offset:[-1,5],count:Object.keys(n).length,children:e.jsx(z,{onClick:()=>x(!0),type:"primary",children:"Vista Previa"})})," "]}),children:w?e.jsxs(e.Fragment,{children:[e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0})]}):o.length>0?e.jsx(e.Fragment,{children:e.jsx(j.Item,{style:{height:"200px",overflowY:"auto"},name:"materias",children:e.jsx(Le.Group,{options:o,onChange:u,value:h,style:{display:"flex",flexDirection:"column",padding:"1px"},optionType:"button",buttonStyle:"solid"})})}):e.jsx(Q,{})})}),e.jsx(M,{xs:24,sm:24,md:11,lg:11,xl:11,children:e.jsx(B,{styles:{title:{overflow:"visible"}},title:e.jsxs(e.Fragment,{children:["Logros de aprendizaje",e.jsx(_,{offset:[2,-20],count:b.length})," "]}),children:S?e.jsxs(e.Fragment,{children:[e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0}),e.jsx(L,{active:!0,avatar:!0})]}):i.length>0?e.jsxs(e.Fragment,{children:[e.jsx(N,{indeterminate:U,onChange:D,checked:K,children:"Seleccionar todos"}),e.jsx(re,{}),e.jsx(j.Item,{style:{height:"130px",overflowY:"auto"},name:"logros",children:e.jsx(N.Group,{style:{display:"flex",flexDirection:"column"},onChange:q,options:i})})]}):e.jsx(Q,{})})})]}),e.jsx(F,{justify:"end",children:e.jsxs(z,{onClick:()=>I(!0),htmlType:"submit",disabled:!Object.keys(n).length>0,type:"primary",style:{marginBlock:"15px"},children:[e.jsx(ne,{}),"  Asignar logros"]})})]})]})},ot=()=>{const[t,a]=r.useState(!1),[m,l]=r.useState(!1),[o,f]=r.useState({}),[i,d]=r.useState(1),[O,$]=r.useState([]),w=J(),E=[{align:"center",key:"codigo",dataIndex:"codigo",title:"Codigo"},{align:"center",key:"descripcion",dataIndex:"descripcion",title:"Descripción"},{align:"center",key:"accion",dataIndex:"accion",title:"Acción"}],S=()=>{switch(i){case 1:w(R()),v.obtenerLogrosAprendizaje().then(b=>{b.data.ok&&$(b.data.data.map((k,V)=>({key:V,id_logros:k.id_logros,descripcion:k.descripcion,codigo:k.codigo,accion:e.jsx(ue,{title:"Modificar descripcion",children:e.jsx(Me,{onClick:()=>{l(!0),f(k)}})})})))}).catch(b=>{w(y({success:!1,title:"Error al agregar logro de aprendizaje",message:b.response.data.error}))}).finally(()=>{w(G())});break}};r.useEffect(()=>{S()},[i]);const A=b=>{d(b)},h=[{key:"2.1",label:"Asignación por materia",children:e.jsx(_e,{})},{key:"2.2",label:"Asignación masiva",children:e.jsx(Be,{})},{key:"2.3",label:"Clonar desde periodo",children:e.jsx(Ne,{})}],p=[{key:"1",label:"Logros aprendizaje",children:e.jsxs(e.Fragment,{children:[e.jsx(De,{cerrar:()=>l(!1),setData:$,data:o,status:m,title:"Modificar logro de aprendizaje"}),e.jsx(F,{justify:"end",style:{margin:"10px"},children:e.jsx(z,{type:"primary",onClick:()=>a(!0),children:"Agregar Logro "})}),e.jsx(Te,{cerrar:()=>a(!1),setData:S,status:t,title:"Agregar logro de aprendizaje"}),e.jsx(xe,{columns:E,dataSource:O})]})},{key:"2",label:"Asignar logros por materia",children:e.jsx(he,{items:h})}];return e.jsxs("div",{children:[e.jsx("h2",{children:"Gestion de logros de aprendizaje"}),e.jsxs(B,{children:[e.jsx(ce,{style:{marginBlock:"10px"},message:e.jsxs(e.Fragment,{children:["Aqui se mostraran los datos de los archivos ingresados en el ",e.jsx("b",{children:"REPORTE NOMINA CARRERA DOCENTE MATERIA"})]}),type:"info",showIcon:!0,closable:!0}),e.jsx(he,{onChange:A,items:p})]})]})};export{ot as default};
